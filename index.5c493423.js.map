{"mappings":"AAAA,MAEMA,EAAO,CACXC,WAAYC,SAASC,cAAc,cACnCC,OAAQF,SAASC,cAAc,WAC/BE,OAAQH,SAASC,cAAc,YAC/BG,cAAeJ,SAASC,cAAc,oBAGxCH,EAAKI,OAAOG,iBAAiB,SAE7B,SAAsBC,GAEpBR,EAAKM,cAAcG,mBAAmB,YADvB,qC,IAIjBT,EAAKC,WAAWM,iBAAiB,UAEjC,SAAqBG,GACnBA,EAAEC,iBAEF,MACMC,EADO,IAAIC,SAASH,EAAEI,eACJC,OAAO,YAajCC,eAA8BJ,GAC5B,MAAMK,EAAYL,EAAWM,KAAIF,MAAMG,IACrC,MAAMC,QAAiBC,MAAM,uCAAeF,KAC5C,IAAKC,EAASE,GACZ,MAAM,IAAIC,MAAM,IAElB,OAAOH,EAASI,MAAM,IAElBC,QAAaC,QAAQC,WAAWV,GAKtC,OAJmBQ,EAChBG,QAAO,EAACC,OAAEA,KAAwB,cAAXA,IACvBC,SAAQ,EAACC,MAAEA,KAAYA,G,EAnB1BC,CAJwBpB,EACrBgB,QAAOT,GAAWA,IAClBD,KAAIC,GAAWA,EAAQc,QAAO,KAAO,OAGrCC,MAAKd,KAuBVJ,eAA0BmB,GACxB,MAAMC,EAAW,+BACXC,EAAU,kCAEVpB,EAAYkB,EAAIjB,KAAIF,MAAMsB,IAC9B,MAAMC,EAAS,IAAIC,gBAAgB,CACjCC,IAAKJ,EACLK,EAAGJ,EACHK,KAAM,OAEFvB,QAAiBC,MAAM,GAAGe,mBAA0BG,KAC1D,IAAKnB,EAASE,GACZ,MAAM,IAAIC,MAAMH,EAASwB,YAG3B,OAAOxB,EAASI,MAAM,IAElBC,QAAaC,QAAQC,WAAWV,GAKtC,OAJsBQ,EACnBG,QAAO,EAACC,OAAEA,KAAwB,cAAXA,IACvBX,KAAI,EAACa,MAAEA,KAAYA,G,EAzClBc,CADiBzB,EAASF,KAAI,EAAC4B,QAAEA,KAAcA,EAAQ,MAClCZ,MAAKT,GAAQsB,QAAQC,IAAIvB,IAAM,IAErDwB,OAAMC,GAAKH,QAAQC,IAAIE,I","sources":["src/js/async-search-form.js"],"sourcesContent":["const BASE_URL = 'https://restcountries.com/v3.1/name';\n\nconst refs = {\n  searchForm: document.querySelector('.js-search'),\n  addBtn: document.querySelector('.js-add'),\n  listEl: document.querySelector('.js-list'),\n  formContainer: document.querySelector('.form-container'),\n};\n\nrefs.addBtn.addEventListener('click', onCountryAdd);\n\nfunction onCountryAdd(evt) {\n  const markup = `<input type=\"text\" name=\"country\">`;\n  refs.formContainer.insertAdjacentHTML('beforeend', markup);\n}\n\nrefs.searchForm.addEventListener('submit', onSearchBtn);\n\nfunction onSearchBtn(e) {\n  e.preventDefault();\n  //   console.dir(e.target);\n  const data = new FormData(e.currentTarget);\n  const arrCountry = data.getAll('country');\n  const filteredCountry = arrCountry\n    .filter(country => country)\n    .map(country => country.replace(/ /g, ''));\n\n  fetchCountries(filteredCountry)\n    .then(responce => {\n      const capitals = responce.map(({ capital }) => capital[0]);\n      getWeather(capitals).then(data => console.log(data));\n    })\n    .catch(e => console.log(e));\n}\n\nasync function fetchCountries(arrCountry) {\n  const responces = arrCountry.map(async country => {\n    const responce = await fetch(`${BASE_URL}/${country}`);\n    if (!responce.ok) {\n      throw new Error('');\n    }\n    return responce.json();\n  });\n  const data = await Promise.allSettled(responces);\n  const countryObj = data\n    .filter(({ status }) => status === 'fulfilled')\n    .flatMap(({ value }) => value);\n\n  return countryObj;\n}\n\nasync function getWeather(arr) {\n  const BASE_URL = `http://api.weatherapi.com/v1`;\n  const API_KEY = `de3d646b80f44831adc131731240809`;\n\n  const responces = arr.map(async city => {\n    const params = new URLSearchParams({\n      key: API_KEY,\n      q: city,\n      lang: 'uk',\n    });\n    const responce = await fetch(`${BASE_URL}//current.json?${params}`);\n    if (!responce.ok) {\n      throw new Error(responce.statusText);\n    }\n\n    return responce.json();\n  });\n  const data = await Promise.allSettled(responces);\n  const filerdWeather = data\n    .filter(({ status }) => status === 'fulfilled')\n    .map(({ value }) => value);\n\n  return filerdWeather;\n}\n"],"names":["$3b69954154aa703f$var$refs","searchForm","document","querySelector","addBtn","listEl","formContainer","addEventListener","evt","insertAdjacentHTML","e1","preventDefault","arrCountry","FormData","currentTarget","getAll","async","responces","map","country","responce","fetch","ok","Error","json","data","Promise","allSettled","filter","status","flatMap","value","$3b69954154aa703f$var$fetchCountries","replace","then","arr","BASE_URL1","API_KEY","city","params","URLSearchParams","key","q","lang","statusText","$3b69954154aa703f$var$getWeather","capital","console","log","catch","e"],"version":3,"file":"index.5c493423.js.map"}